import{DocumentedItemMeta as y}from"./item-meta.mjs";import{DocumentedItem as x}from"./item.mjs";import{DocumentedParam as h}from"./param.mjs";import{DocumentedVarType as d}from"./var-type.mjs";import{parseType as p}from"../util/parseType.mjs";import{isReflectionType as T}from"../util/types.mjs";class b extends x{serializer(){if(this.config.typescript){const i=this.data,c=(i.signatures??[])[0]??i;let u;const v=i.sources?.[0];v&&(u=new y(v,this.config).serialize());const k=c.comment?.blockTags?.filter(t=>t.tag==="@see").length?c.comment.blockTags.filter(t=>t.tag==="@see").map(t=>t.content.find(m=>m.kind==="text")?.text.trim()):void 0,l={name:c.name,description:c.comment?.summary?.reduce((t,m)=>t+=m.text,"").trim()||void 0,see:k,access:i.flags.isPrivate||c.comment?.blockTags?.some(t=>t.tag==="@private"||t.tag==="@internal")?"private":void 0,deprecated:c.comment?.blockTags?.some(t=>t.tag==="@deprecated")?c.comment.blockTags.find(t=>t.tag==="@deprecated")?.content.reduce((t,m)=>t+=m.text,"").trim()??!0:void 0,type:c.type?new d({names:[p(c.type)]},this.config).serialize():void 0,meta:u};let g;if(T(i.type))g=i.type.declaration;else if(i.kindString==="Interface")g=i;else if(i.kindString==="Enumeration")return{...l,props:i.children?.length?i.children.map(t=>({name:t.name,description:t.comment?.summary?.reduce((m,n)=>m+=n.text,"").trim()||void 0,type:[[[t.type?.value]]]})):void 0};if(g){const{children:t,signatures:m}=g;if(t&&t.length>0){const n=t.map(a=>({name:a.name,description:a.comment?.summary?.reduce((s,e)=>s+=e.text,"").trim()||a.signatures?.[0]?.comment?.summary?.reduce((s,e)=>s+=e.text,"").trim()||void 0,optional:a.flags.isOptional||typeof a.defaultValue<"u",default:(a.defaultValue==="..."?void 0:a.defaultValue)??(a.comment?.blockTags?.find(s=>s.tag==="@default")?.content.reduce((s,e)=>s+=e.text,"").trim()||void 0),type:a.type?new d({names:[p(a.type)]},this.config).serialize():a.kindString==="Method"?new d({names:[p({type:"reflection",declaration:a})],description:a.signatures?.[0]?.comment?.blockTags?.find(s=>s.tag==="@returns")?.content.reduce((s,e)=>s+=e.text,"").trim()},this.config).serialize():void 0}));return{...l,props:n}}if(m&&m.length>0){const n=m[0],a=n?.parameters?.map(e=>({name:e.name,description:e.comment?.summary?.reduce((o,f)=>o+=f.text,"").trim()||void 0,optional:e.flags.isOptional||typeof e.defaultValue<"u",default:(e.defaultValue==="..."?void 0:e.defaultValue)??(e.comment?.blockTags?.find(o=>o.tag==="@default")?.content.reduce((o,f)=>o+=f.text,"").trim()||void 0),type:e.type?new d({names:[p(e.type)]},this.config).serialize():void 0})),s=n?.comment?.blockTags?.filter(e=>e.tag==="@see").length?n.comment.blockTags.filter(e=>e.tag==="@see").map(e=>e.content.find(o=>o.kind==="text")?.text.trim()):void 0;return{...l,description:n?.comment?.summary?.reduce((e,o)=>e+=o.text,"").trim()||void 0,see:s,access:n?.flags.isPrivate||n?.comment?.blockTags?.some(e=>e.tag==="@private"||e.tag==="@internal")?"private":void 0,deprecated:n?.comment?.blockTags?.some(e=>e.tag==="@deprecated")?n.comment.blockTags.find(e=>e.tag==="@deprecated")?.content.reduce((e,o)=>e+=o.text,"").trim()??!0:void 0,params:a,returns:n?.type?[new d({names:[p(n.type)],description:n.comment?.blockTags?.find(e=>e.tag==="@returns")?.content.reduce((e,o)=>e+=o.text,"").trim()||void 0},this.config).serialize()]:void 0,returnsDescription:n?.comment?.blockTags?.find(e=>e.tag==="@returns")?.content.reduce((e,o)=>e+=o.text,"").trim()||void 0,meta:u}}}return l}const r=this.data;return{name:r.name,description:r.description,see:r.see,access:r.access,deprecated:r.deprecated,type:new d(r.type,this.config).serialize(),props:r.properties?.length?r.properties.map(i=>new h(i,this.config).serialize()):void 0,params:r.params?.length?r.params.map(i=>new h(i,this.config).serialize()):void 0,returns:r.returns?.length?r.returns.map(i=>new d(i,this.config).serialize()):void 0,meta:new y(r.meta,this.config).serialize()}}}export{b as DocumentedTypeDef};
//# sourceMappingURL=typedef.mjs.map
