"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const h=require("node:path"),p=require("./constructor.cjs"),l=require("./event.cjs"),c=require("./item-meta.cjs"),u=require("./item.cjs"),v=require("./member.cjs"),f=require("./method.cjs"),o=require("./var-type.cjs"),m=require("../util/parseType.cjs");class g extends u.DocumentedItem{constructor(e,a){if(super(e,a),this.props=new Map,this.methods=new Map,this.events=new Map,this.construct=null,this.extends=null,this.implements=null,a.typescript){const s=e,i=s.extendedTypes?.[0];i&&(this.extends=new o.DocumentedVarType({names:[m.parseType(i)]},this.config));const n=s.implementedTypes?.[0];n&&(this.implements=new o.DocumentedVarType({names:[m.parseType(n)]},this.config))}else{const s=e;s.augments&&(this.extends=new o.DocumentedVarType({names:s.augments},this.config)),s.implements&&(this.implements=new o.DocumentedVarType({names:s.implements},this.config))}}add(e){if(e instanceof p.DocumentedConstructor){if(this.construct)throw new Error(`Doc ${this.data.name} already has constructor`);this.construct=e}else if(e instanceof f.DocumentedMethod){const a=e.data.scope==="static"||e.data.flags?.isStatic?"s-":"";if(this.methods.has(a+e.data.name))throw new Error(`Doc ${this.data.name} already has method ${e.data.name}`);this.methods.set(a+e.data.name,e)}else if(e instanceof v.DocumentedMember){if(this.props.has(e.data.name))throw new Error(`Doc ${this.data.name} already has prop ${e.data.name}`);this.props.set(e.data.name,e)}else if(e instanceof l.DocumentedEvent){if(this.events.has(e.data.name))throw new Error(`Doc ${this.data.name} already has event ${e.data.name}`);this.events.set(e.data.name,e)}}serializer(){if(this.config.typescript){const a=this.data,s=(a.signatures??[])[0]??a;let i;const n=a.sources?.[0];n&&(i=new c.DocumentedItemMeta(n,this.config).serialize());const d=s.comment?.blockTags?.filter(t=>t.tag==="@see").length?s.comment.blockTags.filter(t=>t.tag==="@see").map(t=>t.content.find(r=>r.kind==="text")?.text.trim()):void 0;return{name:s.name==="default"?h.parse(i?.file??"default").name:s.name,description:s.comment?.summary.reduce((t,r)=>t+=r.text,"").trim()||void 0,see:d,extends:this.extends?.serialize(),implements:this.implements?.serialize(),access:a.flags.isPrivate||s.comment?.blockTags?.some(t=>t.tag==="@private"||t.tag==="@internal")?"private":void 0,abstract:s.comment?.blockTags?.some(t=>t.tag==="@abstract")||void 0,deprecated:s.comment?.blockTags?.some(t=>t.tag==="@deprecated")?s.comment.blockTags.find(t=>t.tag==="@deprecated")?.content.reduce((t,r)=>t+=r.text,"").trim()??!0:void 0,construct:this.construct?.serialize(),props:this.props.size?[...this.props.values()].map(t=>t.serialize()):void 0,methods:this.methods.size?[...this.methods.values()].map(t=>t.serialize()):void 0,events:this.events.size?[...this.events.values()].map(t=>t.serialize()):void 0,meta:i}}const e=this.data;return{name:e.name,description:e.description,see:e.see,extends:this.extends?.serialize(),implements:this.implements?.serialize(),access:e.access,abstract:e.virtual,deprecated:e.deprecated,construct:this.construct?.serialize(),props:this.props.size?[...this.props.values()].map(a=>a.serialize()):void 0,methods:this.methods.size?[...this.methods.values()].map(a=>a.serialize()):void 0,events:this.events.size?[...this.events.values()].map(a=>a.serialize()):void 0,meta:new c.DocumentedItemMeta(e.meta,this.config).serialize()}}}exports.DocumentedClass=g;
//# sourceMappingURL=class.cjs.map
