{"version":3,"file":"class.cjs","sources":["../../src/types/class.ts"],"sourcesContent":["import { parse } from 'node:path';\nimport type { DeclarationReflection } from 'typedoc';\nimport { DocumentedConstructor } from './constructor.js';\nimport { DocumentedEvent } from './event.js';\nimport { DocumentedItemMeta } from './item-meta.js';\nimport { DocumentedItem } from './item.js';\nimport { DocumentedMember } from './member.js';\nimport { DocumentedMethod } from './method.js';\nimport { DocumentedVarType } from './var-type.js';\nimport type { Class, Config } from '../interfaces/index.js';\nimport { parseType } from '../util/parseType.js';\n\nexport class DocumentedClass extends DocumentedItem<Class | DeclarationReflection> {\n\tpublic readonly props = new Map<string, DocumentedMember>();\n\n\tpublic readonly methods = new Map<string, DocumentedMethod>();\n\n\tpublic readonly events = new Map<string, DocumentedEvent>();\n\n\tpublic construct: DocumentedConstructor | null = null;\n\n\tpublic extends: DocumentedVarType | null = null;\n\n\tpublic implements: DocumentedVarType | null = null;\n\n\tpublic constructor(data: Class | DeclarationReflection, config: Config) {\n\t\tsuper(data, config);\n\n\t\tif (config.typescript) {\n\t\t\tconst d = data as DeclarationReflection;\n\t\t\tconst extended = d.extendedTypes?.[0];\n\t\t\tif (extended) {\n\t\t\t\tthis.extends = new DocumentedVarType({ names: [parseType(extended)] }, this.config);\n\t\t\t}\n\n\t\t\tconst implemented = d.implementedTypes?.[0];\n\t\t\tif (implemented) {\n\t\t\t\tthis.implements = new DocumentedVarType({ names: [parseType(implemented)] }, this.config);\n\t\t\t}\n\t\t} else {\n\t\t\tconst d = data as Class;\n\t\t\tif (d.augments) {\n\t\t\t\tthis.extends = new DocumentedVarType({ names: d.augments }, this.config);\n\t\t\t}\n\n\t\t\tif (d.implements) {\n\t\t\t\tthis.implements = new DocumentedVarType({ names: d.implements }, this.config);\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic add(item: DocumentedConstructor | DocumentedMethod | DocumentedMember | DocumentedEvent) {\n\t\tif (item instanceof DocumentedConstructor) {\n\t\t\tif (this.construct) {\n\t\t\t\tthrow new Error(`Doc ${this.data.name} already has constructor`);\n\t\t\t}\n\t\t\tthis.construct = item;\n\t\t} else if (item instanceof DocumentedMethod) {\n\t\t\t// @ts-expect-error\n\t\t\t// eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\n\t\t\tconst prefix = item.data.scope === 'static' || item.data.flags?.isStatic ? 's-' : '';\n\t\t\tif (this.methods.has(prefix + item.data.name)) {\n\t\t\t\tthrow new Error(`Doc ${this.data.name} already has method ${item.data.name}`);\n\t\t\t}\n\t\t\tthis.methods.set(prefix + item.data.name, item);\n\t\t} else if (item instanceof DocumentedMember) {\n\t\t\tif (this.props.has(item.data.name)) {\n\t\t\t\tthrow new Error(`Doc ${this.data.name} already has prop ${item.data.name}`);\n\t\t\t}\n\t\t\tthis.props.set(item.data.name, item);\n\t\t} else if (item instanceof DocumentedEvent) {\n\t\t\tif (this.events.has(item.data.name)) {\n\t\t\t\tthrow new Error(`Doc ${this.data.name} already has event ${item.data.name}`);\n\t\t\t}\n\t\t\tthis.events.set(item.data.name, item);\n\t\t}\n\t}\n\n\tpublic override serializer() {\n\t\tif (this.config.typescript) {\n\t\t\tconst data = this.data as DeclarationReflection;\n\t\t\tconst signature = (data.signatures ?? [])[0] ?? data;\n\t\t\tlet meta;\n\n\t\t\tconst sources = data.sources?.[0];\n\t\t\tif (sources) {\n\t\t\t\tmeta = new DocumentedItemMeta(sources, this.config).serialize();\n\t\t\t}\n\n\t\t\t// eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n\t\t\tconst see = signature.comment?.blockTags?.filter((t) => t.tag === '@see').length\n\t\t\t\t? signature.comment.blockTags\n\t\t\t\t\t\t.filter((t) => t.tag === '@see')\n\t\t\t\t\t\t.map((t) => t.content.find((c) => c.kind === 'text')?.text.trim())\n\t\t\t\t: undefined;\n\n\t\t\treturn {\n\t\t\t\t// @ts-expect-error\n\t\t\t\t// eslint-disable-next-line @typescript-eslint/no-unsafe-argument\n\t\t\t\tname: signature.name === 'default' ? parse(meta?.file ?? 'default').name : signature.name,\n\t\t\t\t// eslint-disable-next-line @typescript-eslint/prefer-nullish-coalescing\n\t\t\t\tdescription: signature.comment?.summary.reduce((prev, curr) => (prev += curr.text), '').trim() || undefined,\n\t\t\t\tsee,\n\t\t\t\textends: this.extends?.serialize(),\n\t\t\t\timplements: this.implements?.serialize(),\n\t\t\t\taccess:\n\t\t\t\t\tdata.flags.isPrivate ||\n\t\t\t\t\t// eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n\t\t\t\t\tsignature.comment?.blockTags?.some((t) => t.tag === '@private' || t.tag === '@internal')\n\t\t\t\t\t\t? 'private'\n\t\t\t\t\t\t: undefined,\n\t\t\t\t// eslint-disable-next-line @typescript-eslint/prefer-nullish-coalescing, @typescript-eslint/no-unnecessary-condition\n\t\t\t\tabstract: signature.comment?.blockTags?.some((t) => t.tag === '@abstract') || undefined,\n\t\t\t\t// eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n\t\t\t\tdeprecated: signature.comment?.blockTags?.some((t) => t.tag === '@deprecated')\n\t\t\t\t\t? signature.comment.blockTags\n\t\t\t\t\t\t\t.find((t) => t.tag === '@deprecated')\n\t\t\t\t\t\t\t?.content.reduce((prev, curr) => (prev += curr.text), '')\n\t\t\t\t\t\t\t.trim() ?? true\n\t\t\t\t\t: undefined,\n\t\t\t\tconstruct: this.construct?.serialize(),\n\t\t\t\tprops: this.props.size ? [...this.props.values()].map((p) => p.serialize()) : undefined,\n\t\t\t\tmethods: this.methods.size ? [...this.methods.values()].map((m) => m.serialize()) : undefined,\n\t\t\t\tevents: this.events.size ? [...this.events.values()].map((e) => e.serialize()) : undefined,\n\t\t\t\tmeta,\n\t\t\t};\n\t\t}\n\n\t\tconst data = this.data as Class;\n\t\treturn {\n\t\t\tname: data.name,\n\t\t\tdescription: data.description,\n\t\t\tsee: data.see,\n\t\t\textends: this.extends?.serialize(),\n\t\t\timplements: this.implements?.serialize(),\n\t\t\taccess: data.access,\n\t\t\tabstract: data.virtual,\n\t\t\tdeprecated: data.deprecated,\n\t\t\tconstruct: this.construct?.serialize(),\n\t\t\tprops: this.props.size ? [...this.props.values()].map((p) => p.serialize()) : undefined,\n\t\t\tmethods: this.methods.size ? [...this.methods.values()].map((m) => m.serialize()) : undefined,\n\t\t\tevents: this.events.size ? [...this.events.values()].map((e) => e.serialize()) : undefined,\n\t\t\tmeta: new DocumentedItemMeta(data.meta, this.config).serialize(),\n\t\t};\n\t}\n}\n"],"names":["h","r","d","p","g","f","u","c","l"],"mappings":"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"}